(*Funcion recursiva para ordenar listas*)
let rec sorted = function
    h1::h2::t -> h1 <= h2 && sorted (h2::t)
  | _ -> true

(*Ejemplo*)
let bigl = List.init 35_000_000 abs;; (*Creamos una lista bigl con 35000000 de elementos*)
(*val bigl : int list =
  [0; 1; 2; 3; 4; 5; 6; 7; 8; 9; 10; 11; 12; 13; 14; 15; 16; 17; 18; 19; 20;
   21; 22; 23; 24; 25; 26; 27; 28; 29; 30; 31; 32; 33; 34; 35; 36; 37; 38;
   39; 40; 41; 42; 43; 44; 45; 46; 47; 48; 49; 50; 51; 52; 53; 54; 55; 56;
   57; 58; 59; 60; 61; 62; 63; 64; 65; 66; 67; 68; 69; 70; 71; 72; 73; 74;
   75; 76; 77; 78; 79; 80; 81; 82; 83; 84; 85; 86; 87; 88; 89; 90; 91; 92;
   93; 94; 95; 96; 97; 98; 99; 100; 101; 102; 103; 104; 105; 106; 107; 108;
   109; 110; 111; 112; 113; 114; 115; 116; 117; 118; 119; 120; 121; 122; 123;
   124; 125; 126; 127; 128; 129; 130; 131; 132; 133; 134; 135; 136; 137; 138;
   139; 140; 141; 142; 143; 144; 145; 146; 147; 148; 149; 150; 151; 152; 153;
   154; 155; 156; 157; 158; 159; 160; 161; 162; 163; 164; 165; 166; 167; 168;
   169; 170; 171; 172; 173; 174; 175; 176; 177; 178; 179; 180; 181; 182; 183;
   184; 185; 186; 187; 188; 189; 190; 191; 192; 193; 194; 195; 196; 197; 198;
   199; 200; 201; 202; 203; 204; 205; 206; 207; 208; 209; 210; 211; 212; 213;
   214; 215; 216; 217; 218; 219; 220; 221; 222; 223; 224; 225; 226; 227; 228;
   229; 230; 231; 232; 233; 234; 235; 236; 237; 238; 239; 240; 241; 242; 243;
   244; 245; 246; 247; 248; 249; 250; 251; 252; 253; 254; 255; 256; 257; 258;
   259; 260; 261; 262; 263; 264; 265; 266; 267; 268; 269; 270; 271; 272; 273;
   274; 275; 276; 277; 278; 279; 280; 281; 282; 283; 284; 285; 286; 287; 288;
   289; 290; 291; 292; 293; 294; 295; 296; 297; 298; ...]*)
sorted bigl;;
(*- : bool = true*)

(*Insert no terminal*)
let rec insert x = function
    [] -> [x]
  | h::t -> 
    if x <= h then x::h::t 
    else h :: insert x t;;

(*Ejemplos
# insert 3 [1;2;4];;
- : int list = [1; 2; 3; 4]
# insert 5 [1;2;4];;
- : int list = [1; 2; 4; 5]
# insert 0 [1;2;4];;
- : int list = [0; 1; 2; 4]
# insert 35_000_000 bigl;;
Stack overflow during evaluation (looping recursion?).
*)

(*Insert terminal*)
let insert' x l =
  let rec aux acu lista =
    match lista with
        [] -> List.rev(x::acu)
      | h :: t ->
          if x <= h then List.rev_append acu (x :: h :: t)
          else aux (h::acu) t
  in 
  aux [] l;;

(*Ejemplos
# insert' 3 [1;2;4];;
- : int list = [1; 2; 3; 4]
# insert' 5 [1;2;4];;
- : int list = [1; 2; 4; 5]
# insert' 0 [1;2;4];;
- : int list = [0; 1; 2; 4]
# insert' 35_000_000 bigl;;
- : int list =
[0; 1; 2; 3; 4; 5; 6; 7; 8; 9; 10; 11; 12; 13; 14; 15; 16; 17; 18; 19; 20;
 21; 22; 23; 24; 25; 26; 27; 28; 29; 30; 31; 32; 33; 34; 35; 36; 37; 38; 39;
 40; 41; 42; 43; 44; 45; 46; 47; 48; 49; 50; 51; 52; 53; 54; 55; 56; 57; 58;
 59; 60; 61; 62; 63; 64; 65; 66; 67; 68; 69; 70; 71; 72; 73; 74; 75; 76; 77;
 78; 79; 80; 81; 82; 83; 84; 85; 86; 87; 88; 89; 90; 91; 92; 93; 94; 95; 96;
 97; 98; 99; 100; 101; 102; 103; 104; 105; 106; 107; 108; 109; 110; 111; 112;
 113; 114; 115; 116; 117; 118; 119; 120; 121; 122; 123; 124; 125; 126; 127;
 128; 129; 130; 131; 132; 133; 134; 135; 136; 137; 138; 139; 140; 141; 142;
 143; 144; 145; 146; 147; 148; 149; 150; 151; 152; 153; 154; 155; 156; 157;
 158; 159; 160; 161; 162; 163; 164; 165; 166; 167; 168; 169; 170; 171; 172;
 173; 174; 175; 176; 177; 178; 179; 180; 181; 182; 183; 184; 185; 186; 187;
 188; 189; 190; 191; 192; 193; 194; 195; 196; 197; 198; 199; 200; 201; 202;
 203; 204; 205; 206; 207; 208; 209; 210; 211; 212; 213; 214; 215; 216; 217;
 218; 219; 220; 221; 222; 223; 224; 225; 226; 227; 228; 229; 230; 231; 232;
 233; 234; 235; 236; 237; 238; 239; 240; 241; 242; 243; 244; 245; 246; 247;
 248; 249; 250; 251; 252; 253; 254; 255; 256; 257; 258; 259; 260; 261; 262;
 263; 264; 265; 266; 267; 268; 269; 270; 271; 272; 273; 274; 275; 276; 277;
 278; 279; 280; 281; 282; 283; 284; 285; 286; 287; 288; 289; 290; 291; 292;
 293; 294; 295; 296; 297; 298; ...]*)

 List.rev(insert 35_000_000 bigl);;

(*- : int list =
[35000000; 34999999; 34999998; 34999997; 34999996; 34999995; 34999994;
 34999993; 34999992; 34999991; 34999990; 34999989; 34999988; 34999987;
 34999986; 34999985; 34999984; 34999983; 34999982; 34999981; 34999980;
 34999979; 34999978; 34999977; 34999976; 34999975; 34999974; 34999973;
 34999972; 34999971; 34999970; 34999969; 34999968; 34999967; 34999966;
 34999965; 34999964; 34999963; 34999962; 34999961; 34999960; 34999959;
 34999958; 34999957; 34999956; 34999955; 34999954; 34999953; 34999952;
 34999951; 34999950; 34999949; 34999948; 34999947; 34999946; 34999945;
 34999944; 34999943; 34999942; 34999941; 34999940; 34999939; 34999938;
 34999937; 34999936; 34999935; 34999934; 34999933; 34999932; 34999931;
 34999930; 34999929; 34999928; 34999927; 34999926; 34999925; 34999924;
 34999923; 34999922; 34999921; 34999920; 34999919; 34999918; 34999917;
 34999916; 34999915; 34999914; 34999913; 34999912; 34999911; 34999910;
 34999909; 34999908; 34999907; 34999906; 34999905; 34999904; 34999903;
 34999902; 34999901; 34999900; 34999899; 34999898; 34999897; 34999896;
 34999895; 34999894; 34999893; 34999892; 34999891; 34999890; 34999889;
 34999888; 34999887; 34999886; 34999885; 34999884; 34999883; 34999882;
 34999881; 34999880; 34999879; 34999878; 34999877; 34999876; 34999875;
 34999874; 34999873; 34999872; 34999871; 34999870; 34999869; 34999868;
 34999867; 34999866; 34999865; 34999864; 34999863; 34999862; 34999861;
 34999860; 34999859; 34999858; 34999857; 34999856; 34999855; 34999854;
 34999853; 34999852; 34999851; 34999850; 34999849; 34999848; 34999847;
 34999846; 34999845; 34999844; 34999843; 34999842; 34999841; 34999840;
 34999839; 34999838; 34999837; 34999836; 34999835; 34999834; 34999833;
 34999832; 34999831; 34999830; 34999829; 34999828; 34999827; 34999826;
 34999825; 34999824; 34999823; 34999822; 34999821; 34999820; 34999819;
 34999818; 34999817; 34999816; 34999815; 34999814; 34999813; 34999812;
 34999811; 34999810; 34999809; 34999808; 34999807; 34999806; 34999805;
 34999804; 34999803; 34999802; 34999801; 34999800; 34999799; 34999798;
 34999797; 34999796; 34999795; 34999794; 34999793; 34999792; 34999791;
 34999790; 34999789; 34999788; 34999787; 34999786; 34999785; 34999784;
 34999783; 34999782; 34999781; 34999780; 34999779; 34999778; 34999777;
 34999776; 34999775; 34999774; 34999773; 34999772; 34999771; 34999770;
 34999769; 34999768; 34999767; 34999766; 34999765; 34999764; 34999763;
 34999762; 34999761; 34999760; 34999759; 34999758; 34999757; 34999756;
 34999755; 34999754; 34999753; 34999752; 34999751; 34999750; 34999749;
 34999748; 34999747; 34999746; 34999745; 34999744; 34999743; 34999742;
 34999741; 34999740; 34999739; 34999738; 34999737; 34999736; 34999735;
 34999734; 34999733; 34999732; 34999731; 34999730; 34999729; 34999728;
 34999727; 34999726; 34999725; 34999724; 34999723; 34999722; 34999721;
 34999720; 34999719; 34999718; 34999717; 34999716; 34999715; 34999714;
 34999713; 34999712; 34999711; 34999710; 34999709; 34999708; 34999707;
 34999706; 34999705; 34999704; 34999703; 34999702; ...]*)

(*Insertar y ordenar no terminal*)
let rec insert_sort = function
    [] -> []
  | h::t -> insert h (insert_sort t);;

(*Ejemplo
# insert_sort [2;3;1;5;-2;10;8;0];;
- : int list = [-2; 0; 1; 2; 3; 5; 8; 10]
# let l = List.init 100 (function _ -> Random.int 10_000);; (*Crear una lista random*)
val l : int list =
  [9754; 3262; 3510; 4865; 6996; 1861; 7495; 5037; 4283; 5434; 2098; 8495;
   5144; 5034; 806; 3028; 3180; 4058; 2416; 4138; 2654; 9649; 8946; 2876;
   8887; 8794; 7764; 4342; 572; 136; 3177; 8855; 3717; 2837; 8746; 1130;
   5287; 4420; 2232; 6216; 3911; 3467; 8247; 2728; 2927; 8202; 2103; 4194;
   2398; 2104; 2290; 3747; 788; 7757; 7554; 6817; 5151; 4077; 2207; 4621;
   1961; 5736; 6743; 3952; 2621; 8097; 5855; 2643; 5479; 5733; 3443; 4139;
   7774; 1655; 3226; 2977; 1913; 990; 4073; 1484; 8513; 3564; 2666; 2849;
   9579; 2561; 8381; 2441; 3593; 8476; 8497; 2275; 5567; 8647; 8206; 4707;
   8528; 117; 7975; 7999]
# insert_sort l;;
- : int list =
[117; 136; 572; 788; 806; 990; 1130; 1484; 1655; 1861; 1913; 1961; 2098;
 2103; 2104; 2207; 2232; 2275; 2290; 2398; 2416; 2441; 2561; 2621; 2643;
 2654; 2666; 2728; 2837; 2849; 2876; 2927; 2977; 3028; 3177; 3180; 3226;
 3262; 3443; 3467; 3510; 3564; 3593; 3717; 3747; 3911; 3952; 4058; 4073;
 4077; 4138; 4139; 4194; 4283; 4342; 4420; 4621; 4707; 4865; 5034; 5037;
 5144; 5151; 5287; 5434; 5479; 5567; 5733; 5736; 5855; 6216; 6743; 6817;
 6996; 7495; 7554; 7757; 7764; 7774; 7975; 7999; 8097; 8202; 8206; 8247;
 8381; 8476; 8495; 8497; 8513; 8528; 8647; 8746; 8794; 8855; 8887; 8946;
 9579; 9649; 9754]
*)

(*Insertar y ordenar terminal*)
let insert_sort' l =
  let rec aux ordenados = function
      [] -> ordenados
    | h::t -> aux (insert' h ordenados) t
  in aux [] l;;
(*val insert_sort' : 'a list -> 'a list = <fun>*)

(*Ejemplo
# insert_sort' l;;
- : int list =
[117; 136; 572; 788; 806; 990; 1130; 1484; 1655; 1861; 1913; 1961; 2098;
 2103; 2104; 2207; 2232; 2275; 2290; 2398; 2416; 2441; 2561; 2621; 2643;
 2654; 2666; 2728; 2837; 2849; 2876; 2927; 2977; 3028; 3177; 3180; 3226;
 3262; 3443; 3467; 3510; 3564; 3593; 3717; 3747; 3911; 3952; 4058; 4073;
 4077; 4138; 4139; 4194; 4283; 4342; 4420; 4621; 4707; 4865; 5034; 5037;
 5144; 5151; 5287; 5434; 5479; 5567; 5733; 5736; 5855; 6216; 6743; 6817;
 6996; 7495; 7554; 7757; 7764; 7774; 7975; 7999; 8097; 8202; 8206; 8247;
 8381; 8476; 8495; 8497; 8513; 8528; 8647; 8746; 8794; 8855; 8887; 8946;
 9579; 9649; 9754]*)